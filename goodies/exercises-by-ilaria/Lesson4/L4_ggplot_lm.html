<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ilaria Venagli (PhD), Dr.&nbsp;Massimiliano Canzi">

<title>Lesson 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="L4_ggplot_lm_files/libs/clipboard/clipboard.min.js"></script>
<script src="L4_ggplot_lm_files/libs/quarto-html/quarto.js"></script>
<script src="L4_ggplot_lm_files/libs/quarto-html/popper.min.js"></script>
<script src="L4_ggplot_lm_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="L4_ggplot_lm_files/libs/quarto-html/anchor.min.js"></script>
<link href="L4_ggplot_lm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L4_ggplot_lm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="L4_ggplot_lm_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="L4_ggplot_lm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="L4_ggplot_lm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="L4_ggplot_lm_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="L4_ggplot_lm_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#last-time" id="toc-last-time" class="nav-link active" data-scroll-target="#last-time"><span class="toc-section-number">1</span>  Last time…</a></li>
  <li><a href="#homework-solutions" id="toc-homework-solutions" class="nav-link" data-scroll-target="#homework-solutions"><span class="toc-section-number">2</span>  Homework solutions</a>
  <ul class="collapse">
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1"><span class="toc-section-number">2.1</span>  Exercise 1</a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2"><span class="toc-section-number">2.2</span>  Exercise 2</a></li>
  <li><a href="#exercise-3-challenge" id="toc-exercise-3-challenge" class="nav-link" data-scroll-target="#exercise-3-challenge"><span class="toc-section-number">2.3</span>  Exercise 3: challenge!</a></li>
  </ul></li>
  <li><a href="#ggplot" id="toc-ggplot" class="nav-link" data-scroll-target="#ggplot"><span class="toc-section-number">3</span>  <code>ggplot()</code></a></li>
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression"><span class="toc-section-number">4</span>  Simple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#continuous-categorical" id="toc-continuous-categorical" class="nav-link" data-scroll-target="#continuous-categorical"><span class="toc-section-number">4.1</span>  Continuous ~ Categorical</a>
  <ul class="collapse">
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="toc-section-number">4.1.1</span>  Interpretation:</a></li>
  </ul></li>
  <li><a href="#continuous-continuous" id="toc-continuous-continuous" class="nav-link" data-scroll-target="#continuous-continuous"><span class="toc-section-number">4.2</span>  Continuous ~ Continuous</a></li>
  </ul></li>
  <li><a href="#homework" id="toc-homework" class="nav-link" data-scroll-target="#homework"><span class="toc-section-number">5</span>  Homework</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 4</h1>
<p class="subtitle lead">10th/12th May, 2023</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ilaria Venagli (PhD), Dr.&nbsp;Massimiliano Canzi </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="last-time" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Last time…</h1>
<ul>
<li><p><code>mutate()</code> and <code>if_else()</code></p></li>
<li><p><code>mutate()</code> and <code>case_when()</code></p></li>
<li><p><code>group_by() and summarize()</code></p></li>
<li><p>Introduction to <code>ggplot()</code></p></li>
</ul>
</section>
<section id="homework-solutions" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Homework solutions</h1>
<section id="exercise-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">2.1</span> Exercise 1</h2>
<p>Using the <strong><code>df2</code></strong> data frame:</p>
<ul>
<li><p>calculate the mean and standard deviation of <strong><code>wr_time_z</code></strong> and <strong><code>nwr_time_z</code></strong> <strong>for each diagnosis group</strong>.</p></li>
<li><p><strong>Round the mean and standard deviation</strong> to two decimal places using the <strong><code>round</code></strong> function e.g.&nbsp;<code>round(mean(column),2)</code></p></li>
<li><p>Finally, output it as a <code>kable</code> object</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solution:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"reading_tests2.csv"</span>) <span class="ot">-&gt;</span> df </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group by diagnosis to get computations for each group</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diagnosis) <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># word reading time </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean.wr.time =</span> <span class="fu">round</span>(<span class="fu">mean</span>(wr_time_z),<span class="dv">2</span>), <span class="co"># round(,2) to round to two decimals</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd.wr.time =</span> <span class="fu">round</span>(<span class="fu">sd</span>(wr_time_z),<span class="dv">2</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nonword reading time </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean.nwr.time =</span> <span class="fu">round</span>(<span class="fu">mean</span>(nwr_time_z),<span class="dv">2</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd.nwr.time =</span> <span class="fu">round</span>(<span class="fu">sd</span>(nwr_time_z),<span class="dv">2</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Diagnosis"</span>, <span class="st">"Word reading time (M)"</span>, <span class="st">"sd"</span>, <span class="st">"Nonword reading time (M)"</span>, <span class="st">"sd"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Diagnosis </th>
   <th style="text-align:right;"> Word reading time (M) </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> Nonword reading time (M) </th>
   <th style="text-align:right;"> sd </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> NO </td>
   <td style="text-align:right;"> -0.52 </td>
   <td style="text-align:right;"> 1.18 </td>
   <td style="text-align:right;"> -0.21 </td>
   <td style="text-align:right;"> 1.20 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> YES </td>
   <td style="text-align:right;"> -3.31 </td>
   <td style="text-align:right;"> 1.76 </td>
   <td style="text-align:right;"> -2.11 </td>
   <td style="text-align:right;"> 1.23 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="exercise-2" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="exercise-2"><span class="header-section-number">2.2</span> Exercise 2</h2>
<ul>
<li><p>Using the <strong><code>df</code></strong> data frame, create <strong>four boxplots</strong> showing the scores <!--# previously: density. My mistake! --> of <strong><code>wr_time_z</code></strong>, <strong><code>wr_error_z</code></strong>, <strong><code>nwr_time_z</code></strong>, and <strong><code>nwr_error_z</code></strong> <strong>for each diagnosis group</strong>.</p></li>
<li><p>Use the <strong><code>ggarrange</code></strong> function to arrange the four plots into a grid with a common legend.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solution </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diagnosis, <span class="at">y =</span> wr_time_z, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"deepskyblue4"</span>, <span class="st">"indianred3"</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Word reading time"</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diagnosis, <span class="at">y =</span> nwr_time_z, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"deepskyblue4"</span>, <span class="st">"indianred3"</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Nonword reading time"</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diagnosis, <span class="at">y =</span> wr_error_z, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"deepskyblue4"</span>, <span class="st">"indianred3"</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Word reading errors"</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diagnosis, <span class="at">y =</span> nwr_error_z, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"deepskyblue4"</span>, <span class="st">"indianred3"</span>))<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Nonword reading errors"</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="at">common.legend =</span> T,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="at">legend =</span> <span class="st">"bottom"</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="L4_ggplot_lm_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exercise-3-challenge" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="exercise-3-challenge"><span class="header-section-number">2.3</span> Exercise 3: challenge!</h2>
<ol type="1">
<li><p>Read in the “reading_tests2.csv” dataset using the <code>read_csv()</code> function and</p></li>
<li><p><code>select</code> the columns “ID”, “diagnosis”, “class”, and “fdp_wr_time”.</p></li>
<li><p><code>Filter</code> out all rows where the “class” column contains the value “uni”.</p></li>
<li><p>Create two new columns called “poor.reader” and “typical” using the <code>mutate</code>function: The “<strong>poor.reader</strong>” column should contain a 1 if the “<strong>fdp_wr_time</strong>” column contains either “RII” or “RA”, and 0 otherwise. The “<strong>typical</strong>” column should contain a 1 if the “<strong>fdp_wr_time</strong>” column contains either “PS” or “CCR”, and 0 otherwise. Use the function <code>if_else</code> for this.</p></li>
<li><p>Group the data by the “diagnosis” column using the <code>group_by</code> function.</p></li>
<li><p><code>Summarize</code> the data by counting the number of poor readers and typical readers in each diagnosis group using the <code>sum()</code> function and assign the results to a new variable called “<strong>tab1</strong>”.</p></li>
</ol>
<p><strong>Challenge!</strong> Create a grouped bar chart using the <code>ggarrange()</code> function from the “<code>ggpubr::</code>” package. The chart should have two panels, one for the number of poor readers and one for the number of typical readers. The <strong>x-axis</strong> should show the different diagnosis groups, the <strong>y-axis</strong> should show the count of poor readers (plot 1) and the count of typical readers (plot 2), and the <strong>fill</strong> color should be used to distinguish the diagnosis groups. You can use <code>ggplot(aes())</code> + <code>geom_col()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solution</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the columns "ID", "class", and "fdp_wr_time"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID<span class="sc">:</span>class, fdp_wr_time) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter out all rows where the "class" column contains the value "uni".</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">!=</span> <span class="st">"uni"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create two new columns called “poor.reader” and “typical”</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poor.reader =</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">if_else</span>(fdp_wr_time <span class="sc">==</span> <span class="st">"RII"</span> <span class="sc">|</span> fdp_wr_time <span class="sc">==</span> <span class="st">"RA"</span>, <span class="co"># condition poor.reader</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">1</span>, <span class="co"># TRUE value</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span>), <span class="co"># FALSE value </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">typical =</span> <span class="fu">if_else</span>(fdp_wr_time <span class="sc">==</span> <span class="st">"PS"</span> <span class="sc">|</span> fdp_wr_time <span class="sc">==</span> <span class="st">"CCR"</span>, <span class="co"># condition typical </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">1</span>, <span class="co"># TRUE</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co"># FALSE</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diagnosis) <span class="sc">%&gt;%</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">poor.reader =</span> <span class="fu">sum</span>(poor.reader),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">typical =</span> <span class="fu">sum</span>(typical)) <span class="ot">-&gt;</span> tab1</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grouped bar chart </span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT 1: </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>tab1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diagnosis, <span class="at">y =</span> poor.reader, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT 2: </span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>tab1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diagnosis, <span class="at">y =</span> typical, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">width =</span> .<span class="dv">5</span>),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="at">common.legend =</span> T,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="at">legend =</span> <span class="st">"right"</span> </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="L4_ggplot_lm_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="ggplot" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> <code>ggplot()</code></h1>
<ul>
<li><strong><code>ggplot()</code></strong> is a powerful tool to <strong>visualize your data</strong></li>
<li><code>aes():</code>This option defines the aesthetics of the plot by mapping variables from the dataset to visual properties such as x-axis, y-axis, color, etc.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> , <span class="at">y =</span> , <span class="at">fill =</span> , <span class="at">color =</span> )) <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>After defining the aesthetics, you define the <strong>type</strong> of plot with <code>geom_()</code></li>
</ul>
<section id="summary-of-some-useful-geom_" class="level4" data-number="3.0.0.1">
<h4 data-number="3.0.0.1" class="anchored" data-anchor-id="summary-of-some-useful-geom_"><span class="header-section-number">3.0.0.1</span> Summary of some useful <code>geom_()</code></h4>
<ol type="1">
<li><p><strong><code>geom_point()</code></strong>: Scatter plot with points.</p></li>
<li><p><strong><code>geom_line()</code></strong>: Line plot connecting points in order.</p></li>
<li><p><strong><code>geom_bar()/geom_col()</code></strong>: Vertical bar plot for categorical data.</p></li>
<li><p><strong><code>geom_boxplot()</code></strong>: Box plot representing the distribution of a variable.</p></li>
<li><p><strong><code>geom_density()</code></strong>: Density plot for visualizing the distribution of a variable.</p></li>
<li><p><strong><code>geom_violin()</code></strong>: Violin plot, a combination of a density plot and a box plot.</p></li>
<li><p><strong><code>geom_smooth()</code></strong>: Smoothed line or curve plot, typically used for trend lines or fitted curves.</p></li>
<li><p><strong><code>geom_errorbar()</code></strong>: Error bar plot, commonly used to represent uncertainty or confidence intervals.</p></li>
<li><p><strong><code>geom_jitter()</code></strong>: Jittered points plot, useful for avoiding overplotting in scatter plots.</p></li>
<li><p><strong><code>geom_text()</code></strong>: Text labels associated with specific data points in a plot.</p></li>
</ol>
</section>
</section>
<section id="simple-linear-regression" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Simple Linear Regression</h1>
<p>Let’s start with two <strong>research questions</strong> to which we will answer with a simple linear regression model!</p>
<p><strong>RQ1:</strong> What are the differences in <strong>word</strong> and <strong>nonword reading time</strong> between individuals with <strong>dyslexia (DYS)</strong> and typically developing students (TD)?</p>
<p><strong>RQ2:</strong> How does <strong>orthographic knowledge</strong> predict word and nonword reading time?”</p>
<ul>
<li><p><strong>Dependent variables:</strong></p>
<ol type="1">
<li><p>Word reading time</p></li>
<li><p>Nonword reading time</p></li>
</ol></li>
<li><p><strong>Independent variables:</strong></p>
<ol type="1">
<li><p>Diagnosis (YES vs.&nbsp;NO)</p></li>
<li><p>Orthographic knowledge</p></li>
</ol></li>
<li><p><strong>Hypotheses:</strong></p>
<ol type="1">
<li><p>DYS shows <strong>significantly longer (non)word reading times</strong> compared TD</p></li>
<li><p><strong>Larger vocabulary associated with faster (non)word reading</strong>. Stronger effect for word reading time?</p></li>
</ol></li>
</ul>
<div class="cell">

</div>
<section id="continuous-categorical" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="continuous-categorical"><span class="header-section-number">4.1</span> Continuous ~ Categorical</h2>
<p>In the first RQ, we ask whether <code>wr_time_z</code> and <code>nwr_time_z</code> are predicted by <code>diagnosis</code> (YES vs.&nbsp;NO).</p>
<ul>
<li>The outcome/<strong>dependent variables</strong> here are <strong>continuous variables,</strong> while the predictor/<strong>independent variable</strong> is <strong>categorical</strong> (two levels).</li>
</ul>
<p>Let’s look at it with a boxplot:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="L4_ggplot_lm_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Are these differences significant?</strong></p>
<p>We can check whether these differences are significant with a <strong>simple linear regression.</strong> The basic syntax is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>outcome.variable <span class="sc">~</span> <span class="co"># predicted by... </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  predictor.variable,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df <span class="co"># name of your df </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL 1: WORD READING ~ DIAGNOSIS </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's chech whether these differences are significant with a simple linear regression </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. make sure that chr. variables are transformed into fct. </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. run the model </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretation" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">4.1.1</span> Interpretation:</h3>
<ul>
<li>To check the output of a model you can use <code>summary()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># syntax </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>A) Reading a summary output:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><p><strong>Estimates:</strong> These represent the average change in the response variable (dependent variable) associated with a one-unit increase in the predictor, assuming all other variables are held constant. Positive coefficients indicate a positive relationship, while negative coefficients indicate a negative relationship.</p></li>
<li><p><strong>p-values</strong>: Assess the significance of each coefficient. If the p-value is below a predetermined significance level (e.g., 0.05), it suggests that the predictor variable has a statistically significant impact on the response variable.</p></li>
<li><p><strong>R-squared:</strong> The R-squared value (often labeled as “Multiple R-squared”) represents the proportion of the variance in the response variable explained by the model. It ranges from 0 to 1, with a higher value indicating a better fit of the model to the data.</p></li>
<li><p><strong>Residuals</strong>: Examine the residual plots to assess the model’s assumptions. Residuals should be randomly scattered around zero, indicating that the model adequately captures the underlying patterns in the data. Patterns or deviations in the residual plot may suggest potential issues with the model.</p></li>
<li><p><strong>F-statistic:</strong> The F-statistic measures the overall significance of the model. Look for a small p-value (&lt; 0.05) associated with the F-statistic, indicating that the model as a whole is statistically significant.</p></li>
</ol>
<p><strong>B) Visualization</strong></p>
<p>A much easier way to interpret a model is by visualizing its output. One way to do it is using <code>sjPlot::plot_model()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install package! </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("sjPlot")</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># syntax </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(model_name, <span class="at">type =</span> <span class="st">""</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"pred1"</span>,<span class="st">"pred2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s visualize the output of our first model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot model m1 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>---</p>
<p><strong>Nonword reading</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODEL 2: Nonword reading</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lm </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="continuous-continuous" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="continuous-continuous"><span class="header-section-number">4.2</span> Continuous ~ Continuous</h2>
<p>In the second RQ, we ask whether <code>wr_time_z</code> and <code>nwr_time_z</code> are predicted by <code>orthographic knowledge</code></p>
<ul>
<li>Both the outcome/<strong>dependent variable</strong> andthe predictor/<strong>independent variable</strong> are <strong>continuous variables</strong></li>
</ul>
<p>Let’s look at their relation with a scatter plot descriptively:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="L4_ggplot_lm_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Again, <strong>are these differences significant?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EX 2: Let's predict word_reading by orthographic knowledge </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lm </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EX 3: Let's predict noword_reading by orthographic knowledge </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lm </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="homework" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Homework</h1>
<p>Answer at least one of the following RQs with a <strong>simple linear model</strong>. Interpret the model using <strong><code>summary</code></strong> and <strong><code>plot_model()</code></strong>.</p>
<p><strong>RQ1:</strong> What are the differences in <strong>word</strong> and <strong>nonword reading error</strong> between individuals with <strong>dyslexia (DYS)</strong> and typically developing students (TD)?</p>
<p><strong>RQ2:</strong> How does <strong>orthographic knowledge</strong> predict word and nonword reading error?</p>
<p>No challenge this week!</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>